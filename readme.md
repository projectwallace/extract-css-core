<div align="center">
	<h1>extract-css-core</h1>
	<p>Extract all CSS from a given url, both server side and client side rendered.</p>
</div>

[![NPM Version](https://img.shields.io/npm/v/extract-css-core.svg)](https://www.npmjs.com/package/extract-css-core)
[![Weekly downloads](https://img.shields.io/npm/dw/extract-css-core.svg)](https://www.npmjs.com/package/extract-css-core)
![Node.js CI](https://github.com/bartveneman/extract-css-core/workflows/Node.js%20CI/badge.svg)
[![Known Vulnerabilities](https://snyk.io/test/github/bartveneman/extract-css-core/badge.svg)](https://snyk.io/test/github/bartveneman/extract-css-core)
![Dependencies Status](https://img.shields.io/david/bartveneman/extract-css-core.svg)
![Dependencies Status](https://img.shields.io/david/dev/bartveneman/extract-css-core.svg)
[![XO code style](https://img.shields.io/badge/code_style-XO-5ed9c7.svg)](https://github.com/sindresorhus/xo)
[![Project: Wallace](https://img.shields.io/badge/Project-Wallace-29c87d.svg)](https://www.projectwallace.com/oss)

## Usage

```js
const extractCss = require('extract-css-core')

const css = await extractCss('http://www.projectwallace.com')
```

## Installation

```sh
npm install extract-css-core
# or
yarn add extract-css-core
```

## Problem, solution and shortcomings

### Problem

Existing packages like
[get-css](https://github.com/cssstats/cssstats/tree/master/packages/get-css)
look at a server-generated piece of HTML and get all the `<link>` and `<style>`
tags from it. This works fine for 100% server rendered pages üëç, but not for pages with
CSS-in-JS styling and inline styles üëé.

### Solution

This module uses an instance of Chromium to render a page. This has the benefit
that most of the styles can be rendered, even when generated by JavaScript. The
[Puppeteer CSSCoverage API](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#coveragestartcsscoverageoptions)
is the power behind finding most of the CSS. Additionally, the
`document.styleSheets` API is used to get CSS-in-JS styling. Lastly, a plain old `document.querySelectorAll('[style]')` finds all inline styling.

## API

### extractCss(url, [options])

Extract CSS from a page. Returns a Promise that contains the CSS as a single
String, or an Array of all entries found when the option `origins: 'include'` is passed.

### Options

Type: `Object`

Default: `{}`

#### origins

Type: `String`

Default: `exclude`

Possible values: `exclude`, `include`

#### waitUntil

Type: `String`

Default: `networkidle0`

Can be any value as provided by the
[Puppeteer docs](https://github.com/GoogleChrome/puppeteer/blob/master/docs/api.md#pagegotourl-options).

## Related

- [projectwallace.com/get-css](https://www.projectwallace.com/get-css) - Online version of this package
- [Wallace CLI](https://github.com/bartveneman/wallace-cli) - Pretty CSS analytics in your terminal
- [get-css](https://github.com/cssstats/cssstats/tree/master/packages/get-css) - The original get-css from CSSStats
